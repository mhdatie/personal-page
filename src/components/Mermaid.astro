---
const { code } = Astro.props;
const id = `mermaid-${Math.random().toString(36).substr(2, 9)}`;
---

<pre class="mermaid" id={id}>{code}</pre>

<script is:inline>
  if (!window.mermaidLoaded) {
    window.mermaidLoaded = true;

    import('https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.esm.min.mjs')
      .then((module) => {
        const mermaid = module.default;
        mermaid.initialize({
          startOnLoad: true,
          theme: 'default',
        });
        mermaid.run();
      });
  }
</script>

<style>
  .mermaid {
    display: flex;
    justify-content: center;
    margin: 2rem 0;
  }
</style>
